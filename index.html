<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>MyDomains</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>MyDomains</h1>
  </header>
  <main>
    <section class="card">
      <p>Maintain a useful list of domains. Everything is stored in your browser. We never see your data.</p>
      <button type="button" class="primary" id="add-domain-btn">Add Domain</button>
      <button type="button" class="secondary" id="import-export-btn">Import / Export Data</button>
      <span class="small" id="status-msg"></span>
    </section>

    <section class="card" id="domain-table-section">
      <h2>Domains</h2>
      <div id="keyword-filter-container" style="display: none; margin-bottom: 0.75rem;">
        <span class="small">Filtering by keyword: </span>
        <span class="pill pill-active" id="active-keyword-pill"></span>
        <button type="button" class="secondary btn-small" id="clear-keyword-filter">Clear filter</button>
      </div>
      <div class="search-container">
        <input type="text" id="domain-search" placeholder="Search by domain name..." />
        <button type="button" class="clear-btn" id="clear-search">×</button>
      </div>
      <table id="domain-table">
        <thead>
          <tr>
            <th data-sort="name">Domain</th>
            <th data-sort="dnsProvider">DNS</th>
            <th data-sort="expiry">Expiry</th>
            <th data-sort="hostCount">Hosts</th>
            <th>Keywords</th>
            <th data-sort="notes">Notes</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="domain-tbody">
          <!-- rows inserted by JS -->
        </tbody>
      </table>
      <p class="small">Click a row to see details.</p>
    </section>

    <section class="card" id="domain-detail">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:1rem;">
        <div>
          <h2 id="detail-title">Domain details</h2>
          <p class="small" id="detail-notes"></p>
        </div>
        <div>
          <a href="#domain-table-section" class="back-to-top">↑ Back to domain list</a>
        </div>
      </div>
      <div style="display:flex; align-items:center; justify-content:space-between; gap:1rem;">
        <div></div>
        <div>
          <button class="secondary" id="refresh-domain-btn">Refresh DNS / RDAP</button>
          <p class="small" id="detail-last-checked"></p>
        </div>
      </div>

      <h3>Domain summary</h3>
      <div id="detail-summary" class="dns-section small">
        <!-- registrar, expiry, etc. -->
      </div>

      <h3>DNS summary</h3>
      <div id="detail-dns-summary" class="dns-section small">
        <!-- NS/MX/TXT -->
      </div>

      <h3>Hosts</h3>
      <div id="detail-hosts"></div>
    </section>
  </main>

  <footer>
    Made by <a href="https://links.davecross.co.uk/">Dave Cross</a> / Code on <a href="https://github.com/davorg/mydomains">GitHub</a>.
  </footer>

  <!-- Modal for Add/Edit Domain -->
  <div id="domain-modal" class="modal">
    <div class="modal-content">
      <h2 id="form-title">Add Domain</h2>
      <form id="add-domain-form">
        <label for="domain-name">Domain name</label>
        <input type="text" id="domain-name" placeholder="example.com" required />

        <label for="domain-hosts">Subdomains (comma-separated, use @ for root)</label>
        <input type="text" id="domain-hosts" placeholder="@, www, mail" />

        <label for="domain-notes">Notes (optional)</label>
        <textarea id="domain-notes" rows="2" placeholder="Any extra info..."></textarea>

        <label for="domain-keywords">Keywords (comma-separated, optional)</label>
        <input type="text" id="domain-keywords" placeholder="production, personal, important" />

        <div class="modal-buttons">
          <button type="submit" class="primary" id="domain-submit-btn">Add Domain</button>
          <button type="button" class="secondary" id="cancel-edit-btn">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal for Import/Export -->
  <div id="import-export-modal" class="modal">
    <div class="modal-content">
      <h2>Import / Export Data</h2>
      <p class="small">All data is stored in your browser's localStorage. Use export to back up your data, and import to restore from a backup.</p>
      
      <h3>Export</h3>
      <p class="small">Download your current domain inventory as a JSON file.</p>
      <button class="secondary" id="export-btn">Export JSON</button>
      
      <h3>Import</h3>
      <p class="small">Import a previously exported JSON file. This will replace all current data.</p>
      <p class="small"><strong>Minimum format:</strong> A JSON object with a <code>domains</code> array. Each domain must have a <code>name</code> and a <code>hosts</code> array.</p>
      <pre class="small code-block">{
  "domains": [
    {
      "name": "example.com",
      "hosts": [
        { "name": "@" },
        { "name": "www" }
      ]
    }
  ]
}</pre>
      <input type="file" id="import-file" accept="application/json" style="display: none;" />
      <button class="secondary" id="import-btn">Choose File to Import</button>
      
      <div class="modal-buttons">
        <button type="button" class="secondary" id="cancel-import-export-btn">Close</button>
      </div>
    </div>
  </div>

  <!-- Onboarding Modal -->
  <div id="onboarding-modal" class="modal">
    <div class="modal-content">
      <h2>Welcome to MyDomains</h2>
      <p>Get started by adding your first domain or importing an existing list.</p>
      
      <div class="modal-buttons">
        <button type="button" class="primary" id="onboarding-add-btn">Add your first domain</button>
        <button type="button" class="secondary" id="onboarding-import-btn">Import a list of domains</button>
        <button type="button" class="secondary" id="onboarding-cancel-btn">Cancel</button>
      </div>
    </div>
  </div>

  <script src="js/script.js"></script>
</body>
</html>
